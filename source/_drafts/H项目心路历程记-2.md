---
title: H项目心路历程记 (二)
tags:
  - 架构
  - Kubernetes
  - Aliyun
  - Java
categories:
  - 设计
---

**(书接上文)**

前文已经吐槽了产品设计以及中间件上的相关问题。接下来讨论一下技术上的一些问题。

# 关于配置

对于一个Spring的应用来说，应用配置怎么存取其实并不能说是一个技术问题。更应该算是设计或是架构问题。哪些配置应该进入配置文件，通过微服务配置中心(例如Nacos, Apollo，Kubernetes ConfigMap等)来进行在线配置，哪些配置应该通过其他方式来配置，亦或者哪些配置项目看似是配置项其实本质上就是常量。实际上截止现在`H项目`的确在有些微服务上是完全没有厘清三者之间的区别，以及界限。以至于现在堆积在配置文件中的内容实在太多。多个运行环境需要统一维护的难度实在太大。

对于配置来说，理想的状态应该是下面这样的。

1. 通过微服务配置中心来影响Spring的配置文件来实现动态配置的方案，通常会伴随Spring容器的重启(有些情况下甚至需要整个Docker容器)，所以存在这里的配置项应该是随着运行环境改变才会需要改动的配置。例如:

    - 外部系统的链接信息(比如MySQL， Redis的连接信息)
    - 外部系统的认证凭证(数据库用户密码，第三方系统的密钥等)
    - 因为运行环境不同导致的不同变量 (例如)

2. 通过数据库或是Redis存储的配置

