---
title: Largrange项目架构与设计回顾
tags:
    - 架构
    - Kubernetes
    - Aliyun
categories:
    - 设计
date: 2020-05-09 10:34:47
---

> 项目背景

从去年年底开始一个老客户希望在他们的一个传统的机械设备(后面略称 `E机关` )上外装一个Android设备。 Android设备和 `E机关` 之间通过串口或是RJ45接口进行数据交互，主要是Android设备获取 `E机关` 内部的数据，并不会通过接口来控制 `E机关` 。 Android设备则通过4G 来和平台交互，上报Android设备的状态数据，同时接受平台的控制。以此来实现让传统机械设备也能拥抱物联网的概念。

最后围绕着客户的需求分成了3个项目来并行推进

1. Android设备的硬件设备的设计、选材、样机制作与量产规划
2. 在Android设备上,进行与`E机关`以及平台进行交互的APP开发
3. 用于Android设备交互的平台的架构、设计与开发

我们平台Team就负责 `3.用于Android设备交互的平台` 并命名Lagrange (拉格朗日) 。

# 设计&架构

整个平台这块不仅需要向Android设备的APP提供数据交互接口，还需要有一个供相关运营人员使用的前端Web应用，以及与云平台(主要是Aliyun) 、第三方服务提供商 (推送服务，短信服务等)等交互的功能。所以考虑到多方面使用微服务的架构来实现整个平台端。

根据实际业务需要我们将项目分成几个服务

- 提供Android设备的交互接口的 `App Service`
- 提供运营人员使用前端Web应用 `Platform Web Service`
- 前端Web应用使用到的一些接口 `Platform Service`
- 负责第三方服务商交互的 `Push Service`
- 提供云平台鉴权用的 `Auth Service`
- 用来管理任务调度的 `Corn Service`


由于前一个项目实施的时候没有使用容器部署，每当访问量峰值的时候，我们这些码农兼运维就各种加班，所以这次项目决定直接将服务容器化，同时选择了`Kubernetes`来管理容器。


